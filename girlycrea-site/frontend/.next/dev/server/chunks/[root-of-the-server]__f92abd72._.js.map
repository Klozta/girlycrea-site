{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///home/klozta/Projet-Lune/girlycrea-site/frontend/proxy.ts"],"sourcesContent":["/**\n * Next.js Proxy - Sécurité et validation\n * (migration depuis middleware.ts pour Next.js 16)\n */\nimport type { NextRequest } from 'next/server';\nimport { NextResponse } from 'next/server';\n\nconst MAX_INPUT_LENGTH = 10000;\nconst MAX_URL_LENGTH = 2048;\n\nfunction validateRequestParams(request: NextRequest): boolean {\n  const url = request.nextUrl;\n\n  if (url.toString().length > MAX_URL_LENGTH) {\n    return false;\n  }\n\n  const searchParams = url.searchParams;\n  for (const [, value] of searchParams.entries()) {\n    if (value.length > MAX_INPUT_LENGTH) {\n      return false;\n    }\n\n    const dangerousPatterns = [/<script/i, /javascript:/i, /on\\w+\\s*=/i, /eval\\(/i];\n\n    if (dangerousPatterns.some((pattern) => pattern.test(value))) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function proxy(request: NextRequest) {\n  if (!validateRequestParams(request)) {\n    return NextResponse.json({ error: 'Invalid request parameters' }, { status: 400 });\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],\n};\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED;;AAEA,MAAM,mBAAmB;AACzB,MAAM,iBAAiB;AAEvB,SAAS,sBAAsB,OAAoB;IACjD,MAAM,MAAM,QAAQ,OAAO;IAE3B,IAAI,IAAI,QAAQ,GAAG,MAAM,GAAG,gBAAgB;QAC1C,OAAO;IACT;IAEA,MAAM,eAAe,IAAI,YAAY;IACrC,KAAK,MAAM,GAAG,MAAM,IAAI,aAAa,OAAO,GAAI;QAC9C,IAAI,MAAM,MAAM,GAAG,kBAAkB;YACnC,OAAO;QACT;QAEA,MAAM,oBAAoB;YAAC;YAAY;YAAgB;YAAc;SAAU;QAE/E,IAAI,kBAAkB,IAAI,CAAC,CAAC,UAAY,QAAQ,IAAI,CAAC,SAAS;YAC5D,OAAO;QACT;IACF;IAEA,OAAO;AACT;AAEO,SAAS,MAAM,OAAoB;IACxC,IAAI,CAAC,sBAAsB,UAAU;QACnC,OAAO,8IAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;IAEA,OAAO,8IAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAoD;AAChE"}}]
}