{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/klozta/Projet-Lune/zenflow-site/frontend/components/PWAInstallPrompt.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\n\ninterface BeforeInstallPromptEvent extends Event {\n  prompt: () => Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nexport function PWAInstallPrompt() {\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\n  const [showPrompt, setShowPrompt] = useState(false);\n  const [isInstalled, setIsInstalled] = useState(false);\n\n  useEffect(() => {\n    // Vérifier si l'app est déjà installée\n    if (window.matchMedia('(display-mode: standalone)').matches ||\n        (window.navigator as any).standalone === true) {\n      setIsInstalled(true);\n      return;\n    }\n\n    // Écouter l'événement beforeinstallprompt\n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      setDeferredPrompt(e as BeforeInstallPromptEvent);\n\n      // Afficher le prompt après 3 secondes\n      setTimeout(() => {\n        setShowPrompt(true);\n      }, 3000);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n\n    // Vérifier si l'app a été installée\n    window.addEventListener('appinstalled', () => {\n      setIsInstalled(true);\n      setShowPrompt(false);\n      setDeferredPrompt(null);\n    });\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    };\n  }, []);\n\n  const handleInstallClick = async () => {\n    if (!deferredPrompt) return;\n\n    // Afficher le prompt d'installation\n    await deferredPrompt.prompt();\n\n    // Attendre le choix de l'utilisateur\n    const { outcome } = await deferredPrompt.userChoice;\n\n    if (outcome === 'accepted') {\n      console.log('User accepted the install prompt');\n      setIsInstalled(true);\n    } else {\n      console.log('User dismissed the install prompt');\n    }\n\n    setDeferredPrompt(null);\n    setShowPrompt(false);\n  };\n\n  const handleDismiss = () => {\n    setShowPrompt(false);\n    // Ne plus afficher pendant cette session\n    sessionStorage.setItem('pwa-prompt-dismissed', 'true');\n  };\n\n  // Ne pas afficher si déjà installée ou si l'utilisateur a déjà refusé\n  if (isInstalled || !showPrompt || !deferredPrompt) {\n    return null;\n  }\n\n  if (sessionStorage.getItem('pwa-prompt-dismissed') === 'true') {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-slide-up\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4\">\n        <div className=\"flex items-start gap-3\">\n          <div className=\"flex-shrink-0\">\n            <svg\n              className=\"w-6 h-6 text-green-600 dark:text-green-400\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z\"\n              />\n            </svg>\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">\n              Installer ZenFlow\n            </h3>\n            <p className=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">\n              Installez l&apos;application pour un accès rapide et une expérience hors ligne.\n            </p>\n            <div className=\"mt-3 flex gap-2\">\n              <button\n                onClick={handleInstallClick}\n                className=\"flex-1 px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors\"\n              >\n                Installer\n              </button>\n              <button\n                onClick={handleDismiss}\n                className=\"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n              >\n                Plus tard\n              </button>\n            </div>\n          </div>\n          <button\n            onClick={handleDismiss}\n            className=\"flex-shrink-0 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            aria-label=\"Fermer\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AASO,SAAS;;IACd,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAkC;IACtF,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,IAAA,0KAAS;sCAAC;YACR,uCAAuC;YACvC,IAAI,OAAO,UAAU,CAAC,8BAA8B,OAAO,IACvD,AAAC,OAAO,SAAS,CAAS,UAAU,KAAK,MAAM;gBACjD,eAAe;gBACf;YACF;YAEA,0CAA0C;YAC1C,MAAM;wEAA4B,CAAC;oBACjC,EAAE,cAAc;oBAChB,kBAAkB;oBAElB,sCAAsC;oBACtC;gFAAW;4BACT,cAAc;wBAChB;+EAAG;gBACL;;YAEA,OAAO,gBAAgB,CAAC,uBAAuB;YAE/C,oCAAoC;YACpC,OAAO,gBAAgB,CAAC;8CAAgB;oBACtC,eAAe;oBACf,cAAc;oBACd,kBAAkB;gBACpB;;YAEA;8CAAO;oBACL,OAAO,mBAAmB,CAAC,uBAAuB;gBACpD;;QACF;qCAAG,EAAE;IAEL,MAAM,qBAAqB;QACzB,IAAI,CAAC,gBAAgB;QAErB,oCAAoC;QACpC,MAAM,eAAe,MAAM;QAE3B,qCAAqC;QACrC,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,eAAe,UAAU;QAEnD,IAAI,YAAY,YAAY;YAC1B,QAAQ,GAAG,CAAC;YACZ,eAAe;QACjB,OAAO;YACL,QAAQ,GAAG,CAAC;QACd;QAEA,kBAAkB;QAClB,cAAc;IAChB;IAEA,MAAM,gBAAgB;QACpB,cAAc;QACd,yCAAyC;QACzC,eAAe,OAAO,CAAC,wBAAwB;IACjD;IAEA,sEAAsE;IACtE,IAAI,eAAe,CAAC,cAAc,CAAC,gBAAgB;QACjD,OAAO;IACT;IAEA,IAAI,eAAe,OAAO,CAAC,4BAA4B,QAAQ;QAC7D,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BACC,WAAU;4BACV,MAAK;4BACL,QAAO;4BACP,SAAQ;sCAER,cAAA,6LAAC;gCACC,eAAc;gCACd,gBAAe;gCACf,aAAa;gCACb,GAAE;;;;;;;;;;;;;;;;kCAIR,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAyD;;;;;;0CAGvE,6LAAC;gCAAE,WAAU;0CAAgD;;;;;;0CAG7D,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,SAAS;wCACT,WAAU;kDACX;;;;;;kDAGD,6LAAC;wCACC,SAAS;wCACT,WAAU;kDACX;;;;;;;;;;;;;;;;;;kCAKL,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,6LAAC;4BAAI,WAAU;4BAAU,MAAK;4BAAO,QAAO;4BAAe,SAAQ;sCACjE,cAAA,6LAAC;gCACC,eAAc;gCACd,gBAAe;gCACf,aAAa;gCACb,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQlB;GApIgB;KAAA"}}]
}